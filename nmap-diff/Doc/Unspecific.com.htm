<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html class="gr__unspecific_com"><head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Unspecific.com</title>
<link rel="stylesheet" type="text/css" href="Unspecific.com_files/style.css">
<script type="text/javascript" src="Unspecific.com_files/jquery.js"></script>
<script type="text/javascript" src="Unspecific.com_files/script.js"></script>
</head>
<body data-gr-c-s-loaded="true">
<div id="headerSub" class="sub">
	<!-- jQuery handles to place the header background images -->
	<div id="headerimgs">
		<div id="headerimg1" class="headerimg" style="display: block; background-image: url(&quot;/images/header_back2.jpg&quot;); z-index: -7;"></div>
		<div id="headerimg2" class="headerimg" style="background-image: url(&quot;/images/header_back.jpg&quot;); display: none; z-index: -6;"></div>
	</div>
	<!-- Top navigation on top of the images -->
	<div id="nav-outer">
		<div id="navigation">
			<div id="menu">
				<ul>
					<li><a href="http://www.unspecific.com/">Unspecific.com</a></li>
					<li><a href="http://www.twitter.com/unspecific">Twitter</a></li>
					<li><a href="http://www.unspecific.com/picasa.php">Gallery</a></li>
					<li><a href="http://www.unspecific.com/software.php">Software</a></li>
					<li><a href="http://www.dc214.org/">DC214</a></li>
				</ul>
			</div>
		</div>
	</div>
	<div id="headerSubnav-outer">
		<div id="headernav">
			<div id="back" class="btn"></div>
			<div id="control" class="btn"></div>
			<div id="next" class="btn"></div>
		</div>
	</div>
</div>
<div id="wrapper">
<div id="content">
	<p>&nbsp;</p>


<div class="bodytitle">nmap-diff.pl</div>
<div class="mainbody">
<center>Reporting Diffs on the Greapable Nmap...</center>

<br clear="all">
<small><center><a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>

<a name="desc">
<h2>Description</h2>
Wirten by: </a><a href="mailto:madhat@unspecific.com">MadHat at Unspecific.com</a><br>
<br>
cronned to run daily, the nmap-wrapper will generate files logs of ports open. 
This script will generate reports on changes from day to day.

<small><center><hr width="80%" size="1" noshade="noshade"><a href="#top">Top</a> | <a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>
<a name="feat">
<h2>Features</h2>
<ul>
  <li> Uses the nmap-wrapper's logs to generate reports on port changes
  </li><li>  By default shows new open ports
  </li><li>  Can show any port that has changes status <br>
        open-&gt;closed, open-&gt;filtered, closed-&gt;open, etc...
  </li><li> By default will report yseterday and day before, but "yesterday" can 
       be compaired against any day there are logs (-b)
  </li><li>  Can limit to specific subnets  (-s)<br>
        using class A, B or C's at this time (-s 172.21.128)<br>
        multiple subnets can be used by combining with a PIPE<br>
        -s 172.21.128|192.168.100
  </li><li>  Can limit to specific IP (-i)
  </li><li>  Output can be sent directly to an email address for croning a report
</li></ul>

<small></small></a><small><center><a name="feat"><hr width="80%" size="1" noshade="noshade"></a><a href="#top">Top</a> | <a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>
<a name="bugs">
<h2>BUGS</h2>
<ul>
  <li> really simple, so not a lot of options
</li></ul>

<small></small></a><small><center><a name="bugs"><hr width="80%" size="1" noshade="noshade"></a><a href="#top">Top</a> | <a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>
<a name="requi">
<h2>Requirements</h2>
</a><a href="http://www.perl.com/">perl</a> (&gt;5.6 prefered)<br>
<a href="http://www.unspecific.com/nmap/wrapper/">nmap-wrapper</a> (not needed for the program to run, but is needed to produce the searchable files)<br>

<small><center><hr width="80%" size="1" noshade="noshade"><a href="#top">Top</a> | <a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>
<a name="down">
<h2>Download</h2>
</a><a href="http://www.unspecific.com/nmap/diff/nmap-diff.pl">nmap-diff.pl</a> -  v 1.3

<small><center><hr width="80%" size="1" noshade="noshade"><a href="#top">Top</a> | <a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>
<a name="out">
<h2>Output</h2>
An example of the output...
<pre>
172.21.128.9 (jaberwocky.unspecific.com)
    21/tcp    open  ftp
    80/tcp    open  http
   443/tcp    open  https
 + 587/tcp    open  submission
 + 593/tcp    open  http-rpc-epmap

172.21.128.32 (tweedledee.unspecific.com)
 +  22/tcp    open  ssh

172.21.128.37 (tweedledum.unspecific.com)
    22/tcp    open  ssh
 -  25/tcp    open  smtp
    80/tcp    open  http
 - 110/tcp    open  pop3


</pre>
<br><br>

<small></small></a><small><center><a name="out"><hr width="80%" size="1" noshade="noshade"></a><a href="#top">Top</a> | <a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>
<a name="use">
<h2>Usage </h2>
<pre>$ ./nmap-diff.pl  -h
nmap-diff - 1.0 - madahat@unspecific.com

    nmap-diff is designed to be used with the log files
      generated from the nmap-wrapper

./nmap-diff.pl [-hv] [-s <subnet>] [-i <ip>] [-b <days>]
          [-m <email>] [-l <logdir>]

  -h help (this stuff)
  -v is for verbose.  This will add all changed ports.
     Default is to only who new open ports
  -s <subnet> shows only thaing in that subnet.
     At this time the subnet accepted is a class C only.
  -i <ip> only reports on that specific IP.
  -b <days> sets the base to <days> days back and compares
     to yesterday's scan.  so -b 7 will compare the current
     scan to the scan from 1 week ago
  -l <logdir> to specify where the log directory
     This can be hard coded by editing the script
  -m <email> to email the output to <email> when the report
     is generated


</email></email></logdir></days></days></ip></subnet></logdir></email></days></ip></subnet></pre>
<small></small></a><small><center><a name="use"><hr width="80%" size="1" noshade="noshade"></a><a href="#top">Top</a> | <a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>
<a name="license">
<h2>Licensing</h2>
<pre>This product is released under the following License.

# Copyright (c) 2001-2002, MadHat (madhat@unspecific.com)
# All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
#   * Redistributions of source code must retain the above copyright
#     notice, this list of conditions and the following disclaimer.
#   * Redistributions in binary form must reproduce the above copyright
#     notice, this list of conditions and the following disclaimer in
#     the documentation and/or other materials provided with the distribution.
#   * Neither the name of MadHat Productions nor the names of its
#     contributors may be used to endorse or promote products derived
#     from this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
# "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
# LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
# FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
# OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
# SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
# TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
# PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
# LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
# NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
# SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
</pre>
<small></small></a><small><center><a name="license"><hr width="80%" size="1" noshade="noshade"></a><a href="#top">Top</a> | <a href="#desc">Description</a> | <a href="#feat">Features</a> | <a href="#bugs">Bugs</a> | <a href="#requi">Requirements</a> | <a href="#down">Download</a> | <a href="#out">Output</a> | <a href="#use">Usage/Docs</a> | <a href="#license">License</a><hr width="80%" size="1" noshade="noshade"></center></small>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
&nbsp;<br>
</div>

</div>
</div>




</body></html>